---
title: "有意水準を示す*印をつけるExcel関数"
author: "Ryota Mugiyama"
date: "2016-01-31"
categories: "Quantitative methods"
image: ../images/website.jpg
---

2016/11/7 (Mon) 関数に間違いがあったので修正しました。

SPSSやStata、Rなどの統計分析ソフトの出力をExcelに貼り付けて表を整形、加工することはしばしばあると思います。こうした作業はできるだけ早く、かつミスが生じないように行いたいところです。そこで今回は、P値から有意水準を示す星印（アスタリスク）を出力するExcel関数を紹介します。

具体的な使用場面としては、統計ソフトで出力された回帰分析の表をExcelに貼り付けた際に、P値から有意水準を示す星印を自分で書く作業を行う際に用います。以下、よく見る2つのパターンについて、関数を示しておきます。

(1) 「*** p < 0.001, ** p < 0.01, * p < 0.05」の場合
```
=IF(D3="","",IF(D3<0.001,"***",IF(D3<0.01,"**",IF(D3<0.05,"*",""))))
```

(2) 「** p < 0.01, * p < 0.05, † p < 0.1」の場合
```
=IF(D3="","",IF(D3<0.01,"**",IF(D3<0.05,"*",IF(D3<0.1,"†",""))))
```

(3) 「** p < 0.01, * p < 0.05」の場合
```
=IF(D3="","",IF(D3<0.01,"**",IF(D3<0.05,"*","")))
```

(4) 「*** p < 0.001, ** p < 0.01, * p < 0.05, † p < 0.1」の場合
```
=IF(D3="","",IF(D3<0.001,"***",IF(D3<0.01,"**",IF(D3<0.05,"*",IF(D3<0.1,"†","")))))
```
「D3」という部分には適宜参照するセルを代入してください。

関数の中身はIF関数を重ねただけの単純なもので、参照するセルに値が入っている場合には、P値がそれぞれの値を下回っていればそれに該当する印を出力し、どの値も下回らない、または空白である場合は何も出力しない、という論理式となっています。